{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Kramdown IAL Injection",
  "scopeName": "text.kramdown-ial",
  "injectionSelector": "L:text.html.markdown -markup.fenced_code.block.markdown -markup.raw.block.markdown -markup.inline.raw.string.markdown -comment",
  "repository": {
    "attributeContent": {
      "patterns": [
        {
          "name": "comment.line.number-sign.kramdown",
          "match": "#(?=\\s|$)"
        },
        {
          "name": "entity.other.attribute-name.class.kramdown",
          "match": "\\.[A-Za-z0-9_-]+"
        },
        {
          "name": "entity.other.attribute-name.id.kramdown",
          "match": "#[A-Za-z0-9_-]+"
        },
        {
          "name": "string.quoted.double.kramdown",
          "begin": "\"",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.string.begin.kramdown"
            }
          },
          "end": "\"",
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.string.end.kramdown"
            }
          },
          "patterns": [
            {
              "name": "constant.character.escape.kramdown",
              "match": "\\\\."
            }
          ]
        },
        {
          "name": "string.quoted.single.kramdown",
          "begin": "'",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.string.begin.kramdown"
            }
          },
          "end": "'",
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.string.end.kramdown"
            }
          },
          "patterns": [
            {
              "name": "constant.character.escape.kramdown",
              "match": "\\\\."
            }
          ]
        },
        {
          "name": "meta.attribute.assignment.kramdown",
          "match": "([A-Za-z_][A-Za-z0-9_-]*)(\\s*)(=)",
          "captures": {
            "1": {
              "name": "entity.other.attribute-name.kramdown entity.other.attribute-name"
            },
            "3": {
              "name": "keyword.operator.assignment.kramdown"
            }
          }
        },
        {
          "name": "constant.language.boolean.kramdown",
          "match": "\\b(true|false|nil)\\b"
        },
        {
          "name": "constant.numeric.kramdown",
          "match": "\\b\\d+(?:\\.\\d+)?\\b"
        },
        {
          "name": "string.unquoted.attribute-value.kramdown",
          "match": "(?<=\\=)\\s*([A-Za-z0-9][A-Za-z0-9._%\\/-]*)"
        }
      ]
    }
  },
  "patterns": [
    {
      "name": "meta.link.delimiters.injection.markdown",
      "match": "\\[(?=[^\\n\\]]*\\](?:\\(|\\[|:))",
      "captures": {
        "0": {
          "name": "punctuation.definition.link.begin.markdown"
        }
      }
    },
    {
      "name": "meta.link.delimiters.injection.markdown",
      "match": "\\](?=(?:\\(|\\[|:))",
      "captures": {
        "0": {
          "name": "punctuation.definition.link.end.markdown"
        }
      }
    },
    {
      "name": "meta.link.destination.injection.markdown",
      "begin": "(?<=\\])\\(",
      "beginCaptures": {
        "0": {
          "name": "punctuation.definition.link.begin.markdown"
        }
      },
      "end": "\\)",
      "endCaptures": {
        "0": {
          "name": "punctuation.definition.link.end.markdown"
        }
      },
      "patterns": []
    },
    {
      "name": "meta.end-of-block-marker.kramdown",
      "match": "(?m)^(\\s{0,3})(\\^)(\\s*)$",
      "captures": {
        "2": {
          "name": "punctuation.definition.end-of-block-marker.kramdown"
        }
      }
    },
    {
      "name": "meta.header-id.kramdown",
      "match": "(?m)(?<=\\s)(\\{#)([A-Za-z0-9_-]+)(\\})(?=\\s*$)",
      "captures": {
        "1": {
          "name": "punctuation.definition.header-id.begin.kramdown"
        },
        "2": {
          "name": "entity.other.attribute-name.id.kramdown"
        },
        "3": {
          "name": "punctuation.definition.header-id.end.kramdown"
        }
      }
    },
    {
      "name": "meta.extension.kramdown",
      "begin": "(\\{::)([A-Za-z_][A-Za-z0-9_-]*)",
      "beginCaptures": {
        "1": {
          "name": "punctuation.definition.extension.begin.kramdown"
        },
        "2": {
          "name": "entity.name.function.kramdown"
        }
      },
      "end": "(\\})",
      "endCaptures": {
        "1": {
          "name": "punctuation.definition.extension.end.kramdown"
        }
      },
      "patterns": [
        {
          "name": "punctuation.definition.extension.self-close.kramdown",
          "match": "/(?=\\s*\\})"
        },
        {
          "include": "#attributeContent"
        }
      ]
    },
    {
      "name": "meta.extension.end.kramdown",
      "begin": "(\\{:/)([A-Za-z_][A-Za-z0-9_-]*)?",
      "beginCaptures": {
        "1": {
          "name": "punctuation.definition.extension.endtag.begin.kramdown"
        },
        "2": {
          "name": "entity.name.function.kramdown"
        }
      },
      "end": "(\\})",
      "endCaptures": {
        "1": {
          "name": "punctuation.definition.extension.endtag.end.kramdown"
        }
      }
    },
    {
      "name": "meta.attribute-list-definition.kramdown",
      "begin": "(\\{:)(\\s*[A-Za-z0-9][A-Za-z0-9_-]*)(:)",
      "beginCaptures": {
        "1": {
          "name": "punctuation.definition.attribute-list.begin.kramdown"
        },
        "2": {
          "name": "entity.name.label.kramdown"
        },
        "3": {
          "name": "punctuation.separator.attribute-list-definition.kramdown"
        }
      },
      "end": "(\\})",
      "endCaptures": {
        "1": {
          "name": "punctuation.definition.attribute-list.end.kramdown"
        }
      },
      "patterns": [
        {
          "include": "#attributeContent"
        }
      ]
    },
    {
      "name": "meta.attribute-list.kramdown",
      "begin": "(\\{:)(?!:)(?!\\s*[A-Za-z0-9][A-Za-z0-9_-]*:)",
      "beginCaptures": {
        "1": {
          "name": "punctuation.definition.attribute-list.begin.kramdown"
        }
      },
      "end": "(\\})",
      "endCaptures": {
        "1": {
          "name": "punctuation.definition.attribute-list.end.kramdown"
        }
      },
      "patterns": [
        {
          "include": "#attributeContent"
        }
      ]
    }
  ]
}